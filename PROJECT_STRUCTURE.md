# ğŸ“ Baseball Keep Web - å°ˆæ¡ˆçµæ§‹èªªæ˜

## å®Œæ•´å°ˆæ¡ˆçµæ§‹

```
baseball_web/
â”œâ”€â”€ .env.example                    # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md                       # å°ˆæ¡ˆèªªæ˜
â”œâ”€â”€ PROJECT_STRUCTURE.md            # æœ¬æª”æ¡ˆ
â”œâ”€â”€ next.config.ts                  # Next.js è¨­å®š
â”œâ”€â”€ package.json                    # å°ˆæ¡ˆä¾è³´
â”œâ”€â”€ tsconfig.json                   # TypeScript è¨­å®š
â”œâ”€â”€ tailwind.config.ts              # Tailwind CSS è¨­å®š
â”œâ”€â”€ components.json                 # Shadcn UI è¨­å®š
â”‚
â”œâ”€â”€ public/                         # éœæ…‹æª”æ¡ˆ
â”‚   â”œâ”€â”€ manifest.json               # PWA Manifest
â”‚   â”œâ”€â”€ icon-192.png               # PWA åœ–ç¤º (éœ€è‡ªè¡Œå»ºç«‹)
â”‚   â””â”€â”€ icon-512.png               # PWA åœ–ç¤º (éœ€è‡ªè¡Œå»ºç«‹)
â”‚
â”œâ”€â”€ supabase/                       # Supabase ç›¸é—œ
â”‚   â””â”€â”€ migrations/
â”‚       â””â”€â”€ 001_initial_schema.sql   # è³‡æ–™åº« Schema å’Œ RLS
â”‚
â””â”€â”€ src/
    â”œâ”€â”€ app/                        # Next.js App Router
    â”‚   â”œâ”€â”€ api/                    # API è·¯ç”±
    â”‚   â”‚   â”œâ”€â”€ auth/
    â”‚   â”‚   â”‚   â””â”€â”€ getSession/
    â”‚   â”‚   â”‚       â””â”€â”€ route.ts    # å–å¾—ç›®å‰ä½¿ç”¨è€…è³‡è¨Š
    â”‚   â”‚   â”œâ”€â”€ players/
    â”‚   â”‚   â”‚   â”œâ”€â”€ list/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # å–å¾—çƒå“¡åˆ—è¡¨
    â”‚   â”‚   â”‚   â”œâ”€â”€ create/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # æ–°å¢çƒå“¡
    â”‚   â”‚   â”‚   â”œâ”€â”€ update/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # æ›´æ–°çƒå“¡
    â”‚   â”‚   â”‚   â””â”€â”€ delete/
    â”‚   â”‚   â”‚       â””â”€â”€ route.ts    # åˆªé™¤çƒå“¡
    â”‚   â”‚   â”œâ”€â”€ atbats/
    â”‚   â”‚   â”‚   â”œâ”€â”€ list/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # å–å¾—æ‰“æ“Šç´€éŒ„åˆ—è¡¨
    â”‚   â”‚   â”‚   â”œâ”€â”€ create/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # æ–°å¢æ‰“æ“Šç´€éŒ„
    â”‚   â”‚   â”‚   â”œâ”€â”€ update/
    â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts    # æ›´æ–°æ‰“æ“Šç´€éŒ„
    â”‚   â”‚   â”‚   â””â”€â”€ delete/
    â”‚   â”‚   â”‚       â””â”€â”€ route.ts    # åˆªé™¤æ‰“æ“Šç´€éŒ„
    â”‚   â”‚   â””â”€â”€ admin/
    â”‚   â”‚       â””â”€â”€ users/
    â”‚   â”‚           â””â”€â”€ route.ts    # ç®¡ç†ä½¿ç”¨è€…è§’è‰²
    â”‚   â”‚
    â”‚   â”œâ”€â”€ login/
    â”‚   â”‚   â””â”€â”€ page.tsx            # ç™»å…¥é é¢
    â”‚   â”‚
    â”‚   â”œâ”€â”€ admin/
    â”‚   â”‚   â””â”€â”€ users/
    â”‚   â”‚       â””â”€â”€ page.tsx        # ä½¿ç”¨è€…ç®¡ç†é é¢ (admin only)
    â”‚   â”‚
    â”‚   â”œâ”€â”€ players/
    â”‚   â”‚   â””â”€â”€ [id]/
    â”‚   â”‚       â””â”€â”€ page.tsx        # çƒå“¡è©³ç´°é é¢
    â”‚   â”‚
    â”‚   â”œâ”€â”€ record/
    â”‚   â”‚   â””â”€â”€ [player_id]/
    â”‚   â”‚       â”œâ”€â”€ page.tsx        # è¨˜éŒ„æ‰“æ“Šé é¢
    â”‚   â”‚       â””â”€â”€ hitpoint/
    â”‚   â”‚           â””â”€â”€ page.tsx    # æ¨™è¨˜æ‰“æ“Šè½é»é é¢
    â”‚   â”‚
    â”‚   â”œâ”€â”€ stats/
    â”‚   â”‚   â””â”€â”€ [player_id]/
    â”‚   â”‚       â””â”€â”€ page.tsx        # æ‰“æ“Šçµ±è¨ˆé é¢
    â”‚   â”‚
    â”‚   â”œâ”€â”€ layout.tsx               # æ ¹ Layout (åŒ…å« Navbar)
    â”‚   â”œâ”€â”€ page.tsx                 # é¦–é  (çƒå“¡åˆ—è¡¨)
    â”‚   â”œâ”€â”€ globals.css              # å…¨åŸŸæ¨£å¼
    â”‚   â””â”€â”€ favicon.ico
    â”‚
    â”œâ”€â”€ components/                  # React å…ƒä»¶
    â”‚   â”œâ”€â”€ ui/                     # Shadcn UI å…ƒä»¶
    â”‚   â”‚   â”œâ”€â”€ button.tsx
    â”‚   â”‚   â”œâ”€â”€ card.tsx
    â”‚   â”‚   â”œâ”€â”€ input.tsx
    â”‚   â”‚   â”œâ”€â”€ label.tsx
    â”‚   â”‚   â”œâ”€â”€ table.tsx
    â”‚   â”‚   â”œâ”€â”€ dialog.tsx
    â”‚   â”‚   â”œâ”€â”€ select.tsx
    â”‚   â”‚   â””â”€â”€ badge.tsx
    â”‚   â”œâ”€â”€ Navbar.tsx               # å°èˆªåˆ—å…ƒä»¶
    â”‚   â””â”€â”€ HitPointCanvas.tsx      # æ‰“æ“Šè½é»ç•«å¸ƒå…ƒä»¶
    â”‚
    â”œâ”€â”€ lib/                         # å·¥å…·å‡½å¼åº«
    â”‚   â”œâ”€â”€ utils.ts                 # é€šç”¨å·¥å…·å‡½å¼
    â”‚   â”œâ”€â”€ auth.ts                  # èªè­‰ç›¸é—œå‡½å¼
    â”‚   â””â”€â”€ supabase/                # Supabase å®¢æˆ¶ç«¯
    â”‚       â”œâ”€â”€ client.ts            # ç€è¦½å™¨ç«¯å®¢æˆ¶ç«¯
    â”‚       â”œâ”€â”€ server.ts            # ä¼ºæœå™¨ç«¯å®¢æˆ¶ç«¯
    â”‚       â””â”€â”€ middleware.ts        # Middleware å®¢æˆ¶ç«¯
    â”‚
    â””â”€â”€ middleware.ts                # Next.js Middleware
```

## ä¸»è¦æª”æ¡ˆèªªæ˜

### è³‡æ–™åº«ç›¸é—œ
- `supabase/migrations/001_initial_schema.sql`
  - å»ºç«‹æ‰€æœ‰è³‡æ–™è¡¨ï¼ˆprofiles, players, atbatsï¼‰
  - è¨­å®š RLS (Row Level Security) è¦å‰‡
  - å»ºç«‹è‡ªå‹•å»ºç«‹ profile çš„ trigger

### èªè­‰ç›¸é—œ
- `src/lib/auth.ts`
  - `getSession()`: å–å¾—ç›®å‰ä½¿ç”¨è€…è³‡è¨Šå’Œè§’è‰²
  - `requireAuth()`: è¦æ±‚ä½¿ç”¨è€…å¿…é ˆç™»å…¥
  - `requireRole()`: è¦æ±‚ä½¿ç”¨è€…å¿…é ˆæœ‰ç‰¹å®šè§’è‰²

### Supabase å®¢æˆ¶ç«¯
- `src/lib/supabase/client.ts`: ç€è¦½å™¨ç«¯ä½¿ç”¨
- `src/lib/supabase/server.ts`: ä¼ºæœå™¨ç«¯ä½¿ç”¨
- `src/lib/supabase/middleware.ts`: Middleware ä½¿ç”¨

### API è·¯ç”±
æ‰€æœ‰ API è·¯ç”±éƒ½åŒ…å«ï¼š
- èªè­‰æª¢æŸ¥
- è§’è‰²æ¬Šé™æª¢æŸ¥
- éŒ¯èª¤è™•ç†
- æ¨™æº– JSON å›æ‡‰

### å‰ç«¯é é¢
- `/login`: ç™»å…¥é é¢
- `/`: é¦–é ï¼ˆçƒå“¡åˆ—è¡¨ï¼‰
- `/players/[id]`: çƒå“¡è©³ç´°é é¢
- `/record/[player_id]`: è¨˜éŒ„æ‰“æ“Šé é¢
- `/record/[player_id]/hitpoint`: æ¨™è¨˜æ‰“æ“Šè½é»é é¢
- `/stats/[player_id]`: æ‰“æ“Šçµ±è¨ˆé é¢
- `/admin/users`: ä½¿ç”¨è€…ç®¡ç†é é¢ï¼ˆadmin onlyï¼‰

### å…ƒä»¶
- `Navbar`: å°èˆªåˆ—ï¼Œé¡¯ç¤ºä½¿ç”¨è€…è³‡è¨Šå’Œè§’è‰²
- `HitPointCanvas`: å¯äº’å‹•çš„æ£’çƒå ´ç•«å¸ƒï¼Œç”¨æ–¼æ¨™è¨˜æ‰“æ“Šè½é»

## è³‡æ–™æµç¨‹

### ä½¿ç”¨è€…ç™»å…¥æµç¨‹
1. ä½¿ç”¨è€…åœ¨ `/login` è¼¸å…¥å¸³å¯†
2. Supabase Auth é©—è­‰
3. ç³»çµ±æª¢æŸ¥æ˜¯å¦æœ‰å°æ‡‰çš„ profile
4. å¦‚æœæ²’æœ‰ï¼Œè‡ªå‹•å»ºç«‹ viewer è§’è‰²çš„ profile
5. å°å‘é¦–é 

### æ‰“æ“Šç´€éŒ„æµç¨‹
1. Editor/Admin åœ¨é¦–é é»æ“Šã€Œæ–°å¢æ‰“æ“Šç´€éŒ„ã€
2. å¡«å¯«æ‰“æ“Šè³‡è¨Šï¼ˆæ˜¯å¦æ¥è§¸ã€å“è³ªã€çµæœç­‰ï¼‰
3. å¦‚æœæ¥è§¸åˆ°çƒï¼Œå°å‘è½é»æ¨™è¨˜é é¢
4. é»æ“Šçƒå ´æ¨™è¨˜è½é»
5. å„²å­˜å®Œæˆï¼Œå°å‘çƒå“¡è©³ç´°é é¢

### æ¬Šé™æª¢æŸ¥æµç¨‹
1. Middleware æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦ç™»å…¥
2. API è·¯ç”±æª¢æŸ¥ä½¿ç”¨è€…è§’è‰²
3. å‰ç«¯é é¢æ ¹æ“šè§’è‰²é¡¯ç¤º/éš±è—åŠŸèƒ½æŒ‰éˆ•
4. RLS åœ¨è³‡æ–™åº«å±¤é¢ç¢ºä¿è³‡æ–™å®‰å…¨

## ç’°å¢ƒè®Šæ•¸

```env
NEXT_PUBLIC_SUPABASE_URL=your-supabase-project-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
```

## ä¸‹ä¸€æ­¥

1. å»ºç«‹ PWA åœ–ç¤ºï¼ˆicon-192.png, icon-512.pngï¼‰
2. è¨­å®š Supabase å°ˆæ¡ˆ
3. åŸ·è¡Œè³‡æ–™åº« migration
4. å»ºç«‹ç¬¬ä¸€å€‹ admin ä½¿ç”¨è€…
5. é–‹å§‹ä½¿ç”¨ç³»çµ±ï¼
